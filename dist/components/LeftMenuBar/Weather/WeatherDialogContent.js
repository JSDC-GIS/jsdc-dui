import{__awaiter as e,__generator as t,__assign as n}from"../../../node_modules/tslib/tslib.es6.js";import{uniqueId as i}from"lodash";import r,{useRef as o,useState as a,useEffect as c}from"react";import l from"./WeatherCard.js";import{getTwoDays as s}from"./src/api.js";import u from"./src/Weather.js";import m from"../../../icon/index.js";var f=function(){function e(e,t){this.id=i(),this.county=e,this.town=t}return Object.defineProperty(e.prototype,"fullName",{get:function(){return"".concat(this.county," ").concat(this.town)},enumerable:!1,configurable:!0}),e}(),d=function(i){var d=i.locations,p=i.token,h=i.onSelectLocation,v=void 0===h?function(){return null}:h,g=o(null),N=a(!0),E=N[0],w=N[1],b=a(!1),y=b[0],j=b[1],k=a(d.map((function(e){return new f(e.county,e.town)})))[0],C=a(k[0]),W=C[0],x=C[1],L=a([]),D=L[0],M=L[1],O=a({}),P=O[0],S=O[1],_=a(),q=_[0],z=_[1];return c((function(){e(void 0,void 0,void 0,(function(){var e,i,r,o,a,c;return t(this,(function(l){switch(l.label){case 0:e=[],i={},r=function(r){var o,a,c,l,m;return t(this,(function(t){switch(t.label){case 0:return[4,s(r.county,r.town,p)];case 1:return o=t.sent(),a=new u(r.id,o),e.push(a),c=a.wx.getElements(),l=a.temp.getElements(),m=a.ci.getElements(),i[r.id]=c.map((function(e,t){var i=n({},e);return i.temp=l[t].temp,i.ci=m[t].ci,i})),[2]}}))},o=0,a=k,l.label=1;case 1:return o<a.length?(c=a[o],[5,r(c)]):[3,4];case 2:l.sent(),l.label=3;case 3:return o++,[3,1];case 4:return S(i),z(e),M(i[W.id]),w(!1),[2]}}))}))}),[]),r.createElement("div",{className:"dui-WeatherDialogContent"},r.createElement("div",{className:"select",ref:g,onMouseLeave:function(){return j(!1)}},r.createElement("span",{className:"selected",onClick:function(){return j(!y)}},W.fullName,r.createElement("div",{className:"pointer"},"â–¼")),r.createElement("div",{className:"option ".concat(y||"hide")},k.map((function(e){return r.createElement("div",{key:e.fullName,className:"item",onClick:function(){return function(e){x(e),M(P[e.id]);var t=null==q?void 0:q.find((function(t){return t.name===e.id}));j(!1),t&&v([t.location.lat,t.location.lon])}(e)}},e.fullName)})))),E&&r.createElement("img",{className:"loading",src:m.others.processing,alt:"source not found"}),r.createElement("div",{className:"weather-card-container"},D.map((function(e,t){return r.createElement(l,{key:t,title:e.time,img:e.img,degree:e.temp,description:e.description,infoList:[e.ci],imgNum:e.value})}))))};d.displayName="WeatherDialogContent";export{d as default};
//# sourceMappingURL=WeatherDialogContent.js.map
